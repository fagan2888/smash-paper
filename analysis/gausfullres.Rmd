This demo plots SMASH against TI-thresholding (using RMAD to estimate variance) for a variety of mean-variance-snr combinations.


```{r demo, fig.height=4, fig.width=6}
load("../output/dscr.RData")
res_agg = aggregate(mise ~ scenario + method, data = res, FUN = mean)
selected_methods = c("smash.true.s8", "smash.s8", "smash.homo.s8", "tithresh.true.s8", "tithresh.smash.s8", "tithresh.rmad.s8", "ebayesthresh")
res_agg = res_agg[res_agg$method %in% selected_methods, ]
scenarios = unique(res_agg$scenario)

for (scenario in scenarios) {
  
  mise_order = order(res_agg$mise[res_agg$scenario == scenario])
  mise_ordered = sort(res_agg$mise[res_agg$scenario == scenario])
  names_ordered = res_agg$method[res_agg$scenario == scenario][mise_order]
  mise_ordered_rounded = round(mise_ordered, digits = 0)
  
  par(mar=c(9,4,4,2))
  ylim = c(0, 1.2 * max(mise_ordered))
  bp = barplot(mise_ordered, names.arg = names_ordered, ylim = ylim, las = 2)
  text(x = bp, y = mise_ordered, label = mise_ordered_rounded, pos = 3, cex = 0.8, col = "red") 
  title(scenario)
}
  
```
