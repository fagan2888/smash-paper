---
title: "Plots and tables summarizing results of Poisson simulations"
author: "Zhengrong Xing, Peter Carbonetto and Matthew Stephens"
output: workflowr::wflow_html
---

This script produces supplementary tables for Poisson simulations.

*Explain which set of results correspond to the plots given in the main
text.*

```{r knitr-opts, include=FALSE}
knitr::opts_chunk$set(comment = "#",collapse = TRUE,fig.align = "center")
```

Analysis settings
-----------------

We will extract the results from these methods:

```{r selected-methods}
methods <- c("ash","BMSM","haarfisz_R")
```

Specify the row and column names for the tables:

```{r table-row-and-col-names}
table.row.names <- c("SMASH","BMSM","Haar-Fisz")
table.col.names <- c("intensity (0.01,3)","intensity (1/8,8)",
                     "intensity (1/128,128)")
```

These are settings used in plotting the test functions:

```{r plot-settings}
n <- 1024
t <- 1:n/n
```

Set up environment
------------------

*Add text here.*

```{r load-pkgs, message=FALSE, warning=FALSE}
library(ggplot2)
library(cowplot)
library(xtable)
```

Some of the test functions are defined in `signals.R`:

```{r source-signals}
source("../code/signals.R")
```

Load results
------------

Load the results of the simulation experiments.

```{r load-results}
load("../output/pois.RData")
```

Spikes data
-----------

This is the function used to simulate the "Spikes" data sets:


```{r spikes-function, fig.height=5, fig.width=10}
mu.s <- spike.f(t)
plot(t,mu.s,xlab = "",ylab = "",type = "l",
     main = "Spikes intensity function")
```

Summarize the results from the Spikes simulations in a table.

Comparison of methods for denoising Poisson data for the "Spikes"
test function for 3 different (min,max) intensities ((0.01,3),
(1/8,8), (1/128,128)). Performance is measured using MISE over 100
independent datasets, with smaller values indicating better
performance. Values colored in red indicates the smallest MISE amongst
all methods for a given (min, max) intensity.

```{r spikes-table, results="asis"}
mise.s.table   <- cbind(mise.s.1[methods],
                        mise.s.8[methods],
                        mise.s.128[methods])
rownames(mise.s.table) <- table.row.names
colnames(mise.s.table) <- table.col.names
print(xtable(mise.s.table),type = "html")
```

Summarize the results from the Spikes simulations in combined violin
and boxplots.

```{r spikes-violin-plots, fig.height=5, fig.width=7}
mise.hf.ti.r.s.1   <- colMeans(rbind(mise.hf.ti.r.4.s.1,
                                     mise.hf.ti.r.5.s.1,
                                     mise.hf.ti.r.6.s.1,
	  		                         mise.hf.ti.r.7.s.1))
mise.hf.ti.r.s.8   <- colMeans(rbind(mise.hf.ti.r.4.s.8,
					                 mise.hf.ti.r.5.s.8,
                                     mise.hf.ti.r.6.s.8,
						  	         mise.hf.ti.r.7.s.8))
mise.hf.ti.r.s.128 <- colMeans(rbind(mise.hf.ti.r.4.s.128,
									 mise.hf.ti.r.5.s.128,
                                     mise.hf.ti.r.6.s.128,
									 mise.hf.ti.r.7.s.128))
n     <- length(mise.ash.s.1)
pdat1 <- data.frame(method = rep(c("SMASH","BMSM","HF"),each = n),
 				    mise   = c(mise.ash.s.1,mise.BMSM.s.1,mise.hf.ti.r.s.1))
p1 <- ggplot(pdat1,aes(x = method,y = mise)) +
      geom_violin(fill = "skyblue",color = "skyblue") +
      geom_boxplot(width = 0.15,outlier.shape = NA) +
      coord_flip()
      labs(x = "",y = "MISE") +
     theme(axis.line = element_blank(),
           axis.ticks.y = element_blank())
```

Combine the results of the simulation experiments into several larger
tables.

```{r get-spikes-results}
mise.ang.table <- cbind(mise.ang.1[methods],
                        mise.ang.8[methods],
                        mise.ang.128[methods])
mise.bur.table <- cbind(mise.bur.1[methods],
                        mise.bur.8[methods],
                        mise.bur.128[methods])
mise.cb.table  <- cbind(mise.cb.1[methods],
                        mise.cb.8[methods],
                        mise.cb.128[methods])
mise.b.table   <- cbind(mise.b.1[methods],
                        mise.b.8[methods],
                        mise.b.128[methods])
mise.hs.table  <- cbind(mise.hs.1[methods],
                        mise.hs.8[methods],
                        mise.hs.128[methods])
rownames(mise.ang.table) <- table.row.names
rownames(mise.b.table)   <- table.row.names
rownames(mise.cb.table)  <- table.row.names
rownames(mise.hs.table)  <- table.row.names
rownames(mise.bur.table) <- table.row.names
colnames(mise.ang.table) <- table.col.names
colnames(mise.b.table)   <- table.col.names
colnames(mise.cb.table)  <- table.col.names
colnames(mise.hs.table)  <- table.col.names
colnames(mise.bur.table) <- table.col.names
```

### Angles data

```{r, results="asis"}
print(xtable(mise.ang.table,caption="Comparison of methods for denoising Poisson data for the ``Angles'' test function for 3 different (min,max) intensities ((0.01,3), (1/8,8), (1/128,128)). Performance is measured using MISE over 100 independent datasets, with smaller values indicating better performance. Values colored in red indicates the smallest MISE amongst all methods for a given (min, max) intensity.",label="table:pois_ang",digits=2),type = "html")
```

### Heavisine data

```{r, results="asis"}
print(xtable(mise.hs.table,caption="Comparison of methods for denoising Poisson data for the ``Heavisine'' test function for 3 different (min,max) intensities ((0.01,3), (1/8,8), (1/128,128)). Performance is measured using MISE over 100 independent datasets, with smaller values indicating better performance. Values colored in red indicates the smallest MISE amongst all methods for a given (min, max) intensity.",label="table:pois_hs",digits=2),type = "html")
```

### Bursts data

```{r, results="asis"}
print(xtable(mise.bur.table,caption="Comparison of methods for denoising Poisson data for the ``Bursts'' test function for 3 different (min,max) intensities ((0.01,3), (1/8,8), (1/128,128)). Performance is measured using MISE over 100 independent datasets, with smaller values indicating better performance. Values colored in red indicates the smallest MISE amongst all methods for a given (min, max) intensity.",label="table:pois_bur",digits=2),type = "html")
```

### Clipped Blocks data

```{r, results="asis"}
print(xtable(mise.cb.table,caption="Comparison of methods for denoising Poisson data for the ``Clipped Blocks'' test function for 3 different (min,max) intensities ((0.01,3), (1/8,8), (1/128,128)). Performance is measured using MISE over 100 independent datasets, with smaller values indicating better performance. Values colored in red indicates the smallest MISE amongst all methods for a given (min, max) intensity.",label="table:pois_cb",digits=2),type = "html")
```

### Bumps data

```{r, results="asis"}
print(xtable(mise.b.table,caption="Comparison of methods for denoising Poisson data for the ``Bumps'' test function for 3 different (min,max) intensities ((0.01,3), (1/8,8), (1/128,128)). Performance is measured using MISE over 100 independent datasets, with smaller values indicating better performance. Values colored in red indicates the smallest MISE amongst all methods for a given (min, max) intensity.",label="table:pois_b",digits=2),type = "html")
```
