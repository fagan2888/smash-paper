data=as.numeric(data[,1])
library(tseries)
y=ar(data,FALSE,5)$res
y=y[!is.na(y)]
x=sort(data[5:(length(data)-1)])
y=y[order(data[5:(length(data)-1)])]
plot(x,y)
x.mod=unique(x)
y.mod=0
for(i in 1:length(x.mod)){
y.mod[i]=median(y[x==x.mod[i]])
}
y.exp=c(y.mod,y.mod[length(y.mod):(2*length(y.mod)-2^10+1)])
y.final=c(y.exp,y.exp[length(y.exp):1])
y.est=bayesmooth(y.final)
y.est.var=bayesmooth(y.final,v.est=TRUE)
plot(x,y)
lines(x.mod,y.est[1:(length(y.mod))],col=2)
plot(x.mod,sqrt(y.est.var[1:(length(y.mod))]),type='l')
plot(data)
par(mfrow=c(2,2))
plot(data,type='l')
plot(x,y)
lines(x.mod,y.est[1:(length(y.mod))],col=2)
plot(x.mod,y.est[1:(length(y.mod))],type='l',ylim=c(-0.3,0.3))
plot(x.mod,sqrt(y.est.var[1:(length(y.mod))]),type='l')
n=200
mse.hsm.c=0
mse.hsm.n=0
for(i in 1:500){
xt=sort(rnorm(n,0.5,0.2))
xt=(xt-min(xt))/(max(xt)-min(xt))
mu.hsm=4 * sin(4 * pi * xt) - 2*sign(xt - 0.3) - 2*sign(0.72 - xt)
mu.t=mu.hsm
var1=rep(1,n)
var2=(xt<=0.5)+2*(xt>0.5)
sigma.ini=sqrt(var1)
rsnr=sqrt(4)
sigma.t=sigma.ini/mean(sigma.ini)*sd(mu.t)/rsnr^2
y=rnorm(n,mu.t,sigma.t)
y.exp=c(y,y[200:145])
y.final=c(y.exp,y.exp[256:1])
mu.est<-bayesmooth.alt2(y.final)
mu.est=mu.est[1:n]
mse.hsm.c[i]=mse(mu.est,mu.t)
sigma.ini=sqrt(var2)
rsnr=sqrt(4)
sigma.t=sigma.ini/mean(sigma.ini)*sd(mu.t)/rsnr^2
y=rnorm(n,mu.t,sigma.t)
y.exp=c(y,y[200:145])
y.final=c(y.exp,y.exp[256:1])
mu.est<-bayesmooth.alt2(y.final)
mu.est=mu.est[1:n]
mse.hsm.n[i]=mse(mu.est,mu.t)
}
n=200
mse.hsm.c=0
mse.hsm.n=0
for(i in 1:500){
xt=sort(rnorm(n,0.5,0.2))
xt=(xt-min(xt))/(max(xt)-min(xt))
mu.hsm=4 * sin(4 * pi * xt) - 2*sign(xt - 0.3) - 2*sign(0.72 - xt)
mu.t=mu.hsm
var1=rep(1,n)
var2=(xt<=0.5)+2*(xt>0.5)
sigma.ini=sqrt(var1)
rsnr=sqrt(4)
sigma.t=sigma.ini/mean(sigma.ini)*sd(mu.t)/rsnr^2
y=rnorm(n,mu.t,sigma.t)
y.exp=c(y,y[200:145])
y.final=c(y.exp,y.exp[256:1])
mu.est<-bayesmooth(y.final)
mu.est=mu.est[1:n]
mse.hsm.c[i]=mse(mu.est,mu.t)
sigma.ini=sqrt(var2)
rsnr=sqrt(4)
sigma.t=sigma.ini/mean(sigma.ini)*sd(mu.t)/rsnr^2
y=rnorm(n,mu.t,sigma.t)
y.exp=c(y,y[200:145])
y.final=c(y.exp,y.exp[256:1])
mu.est<-bayesmooth(y.final)
mu.est=mu.est[1:n]
mse.hsm.n[i]=mse(mu.est,mu.t)
}
sqrt(median(mse.hsm.c))
sqrt(median(mse.hsm.n))
sqrt(quantile(mse.hsm.c,seq(0.25,0.75,0.25)))
sqrt(quantile(mse.hsm.n,seq(0.25,0.75,0.25)))
library(MASS)
x.ini=sort(mcycle$times)
y.ini=mcycle$accel[order(mcycle$times)]
x=unique(x.ini)
y=0
for(i in 1:length(x)){
y[i]=median(y.ini[x.ini==x[i]])
}
y.exp=c(y,y[length(y):(2*length(y)-128+1)])
y.final=c(y.exp,y.exp[length(y.exp):1])
y.est=bayesmooth(y.final)
y.est=y.est[1:length(y)]
y.var.est=bayesmooth(y.final,v.est=TRUE)
y.var.est=y.var.est[1:length(y)]
plot(x,y,ylim=c(-150,100))
lines(x,y.est,col=2)
par(mfrow=c(1,2))
plot(x,y,ylim=c(-150,100))
lines(x,y.est,col=2)
plot(y.var.est,type='l')
par(mfrow=c(1,2))
plot(x,y,ylim=c(-150,100))
lines(x,y.est,col=2)
plot(x,y.var.est,type='l')
y.var.est
library(lattice)
x.ini=sort(ethanol$E)
y.ini=ethanol$NOx[order(ethanol$E)]
x=unique(x.ini)
y=0
for(i in 1:length(x)){
y[i]=median(y.ini[x.ini==x[i]])
}
y.exp=c(y,y[length(y):(2*length(y)-128+1)])
y.final=c(y.exp,y.exp[length(y.exp):1])
y.est=bayesmooth(y.final)
y.est.alt2=bayesmooth.alt2(y.final)
y.est=y.est[1:length(y)]
y.est.alt2=y.est.alt2[1:length(y)]
y.var.est=bayesmooth(y.final,v.est=TRUE)
y.var.est.alt2=bayesmooth.alt2(y.final,v.est=TRUE)
y.var.est=y.var.est[1:length(y)]
y.var.est.alt2=y.var.est.alt2[1:length(y)]
library(lattice)
x.ini=sort(ethanol$E)
y.ini=ethanol$NOx[order(ethanol$E)]
x=unique(x.ini)
y=0
for(i in 1:length(x)){
y[i]=median(y.ini[x.ini==x[i]])
}
y.exp=c(y,y[length(y):(2*length(y)-128+1)])
y.final=c(y.exp,y.exp[length(y.exp):1])
y.est=bayesmooth(y.final)
y.est=y.est[1:length(y)]
y.var.est=bayesmooth(y.final,v.est=TRUE)
y.var.est=y.var.est[1:length(y)]
par(mfrow=c(1,2))
plot(x,y,ylim=c(-1,5))
lines(x,y.est,col=2)
plot(x,y.var.est,type='l')
knit2html('intro.Rmd')
source(file.path("../Rcode/bayesmooth.R"))
spike.f=function(x) (0.75*exp(-500*(x-0.23)^2)+1.5*exp(-2000*(x-0.33)^2)+3*exp(-8000*(x-0.47)^2)+2.25*exp(-16000*(x-0.69)^2)+0.5*exp(-32000*(x-0.83)^2))
n=1024
t=1:n/n
mu.s=spike.f(t)
mu.t=(1+mu.s)/5
rsnr=sqrt(1)
var1=rep(1,n)
var2=(0.0001+4*(exp(-550*(t-0.2)^2)+exp(-200*(t-0.5)^2)+exp(-950*(t-0.8)^2)))/1.35
sigma.ini=sqrt(var2)
sigma.t=sigma.ini/mean(sigma.ini)*sd(mu.t)/rsnr^2
set.seed(1025)
X.s=rnorm(n,mu.t,sigma.t)
mu.est<-bayesmooth(X.s,sigma=sigma.t)
mu.est.sig=sigma.t*bayesmooth(X.s/sigma.t,sigma=rep(1,n))
mse(mu.est,mu.t)
mse(mu.est.sig,mu.t)
plot(mu.t,type='l')
lines(mu.est,col=2)
lines(mu.est.sig,col=4)
plot(mu.t,type='l')
lines(mu.est,col=2)
lines(mu.est.sig,col=4)
var3=0.00001+mu.b
pos = c(.1, .13, .15, .23, .25, .40, .44, .65, .76, .78, .81)
hgt = 2.97/5*c(4, 5, 3, 4, 5, 4.2, 2.1, 4.3, 3.1, 5.1, 4.2)
wth = c(.005, .005, .006, .01, .01, .03, .01, .01, .005, .008, .005)
mu.b = rep(0,n)
for(j in 1:length(pos)){
mu.b = mu.b + hgt[j]/(( 1 + (abs(t - pos[j])/wth[j]))^4)
}
var3=0.00001+mu.b
sigma.ini=sqrt(var3)
sigma.t=sigma.ini/mean(sigma.ini)*sd(mu.t)/rsnr^2
set.seed(1025)
X.s=rnorm(n,mu.t,sigma.t)
mu.est<-bayesmooth(X.s,sigma=sigma.t)
mu.est.sig=sigma.t*bayesmooth(X.s/sigma.t,sigma=rep(1,n))
mse(mu.est,mu.t)
mse(mu.est.sig,mu.t)
plot(mu.t,type='l')
lines(mu.est,col=2)
lines(mu.est.sig,col=4)
plot(sigma.t)
plot(X.s)
plot(X.s/sigma.t)
rsnr=sqrt(3)
var1=rep(1,n)
var2=(0.0001+4*(exp(-550*(t-0.2)^2)+exp(-200*(t-0.5)^2)+exp(-950*(t-0.8)^2)))/1.35
var3=0.00001+mu.b
sigma.ini=sqrt(var3)
sigma.t=sigma.ini/mean(sigma.ini)*sd(mu.t)/rsnr^2
set.seed(1025)
X.s=rnorm(n,mu.t,sigma.t)
mu.est<-bayesmooth(X.s,sigma=sigma.t)
mu.est.sig=sigma.t*bayesmooth(X.s/sigma.t,sigma=rep(1,n))
mse(mu.est,mu.t)
mse(mu.est.sig,mu.t)
plot(mu.t,type='l')
lines(mu.est,col=2)
lines(mu.est.sig,col=4)
source("../simulation_1d_g/wip/bayesmooth_cur.R")
source("../simulation_1d_g/wip/bayesmooth_log.R")
source("../simulation_1d_g/wip/bayesmooth_jash.R")
source("../simulation_1d_g/wip/bayesmooth_vash.R")
getwd()
setwd("D:/Grad School/Spring 2013/ashwave/tests")
spike.f=function(x) (0.75*exp(-500*(x-0.23)^2)+1.5*exp(-2000*(x-0.33)^2)+3*exp(-8000*(x-0.47)^2)+2.25*exp(-16000*(x-0.69)^2)+0.5*exp(-32000*(x-0.83)^2))
n=2^12
t=1:n/n
mu.s=spike.f(t)
pos = c(.1, .13, .15, .23, .25, .40, .44, .65, .76, .78, .81)
hgt = c(2, 3.6, 2, 5, 7.5, 6.9, 2, 4.8, 2, 4.1, 2.3)
wth = c(.005, .005, .006, .01, .01, .03, .01, .01, .005, .008, .005)
mu.b = rep(0,n)
for(j in 1:length(pos)){
mu.b = mu.b + hgt[j]/(( 1 + (abs(t - pos[j])/wth[j]))^4)
}
dop.f=function(x) sqrt(x*(1-x))*sin((2*pi*1.05)/(x+0.05))
mu.dop=dop.f(t)
mu.sine=sin(20*t)
var1=1.42*((3-20*t)*(t>=0&t<0.1)+(20*t-1)*(t>=0.1&t<0.25)+(4+(1-4*t)*18/19)*(t>=0.25&t<0.725)+(2.2+10*(t-0.725))*(t>=0.725&t<0.89)+(3.85-85*(t-0.89)/11)*(t>=0.89&t<=1))
var2=(1+4*(exp(-550*(t-0.2)^2)+exp(-200*(t-0.5)^2)+exp(-950*(t-0.8)^2)))/1.35
var3=mu.b
var4=3.4*(2+mu.dop)
sigma.t.1=sqrt(var1)
sigma.t.2=sqrt(var2)
sigma.t.3=sqrt(var3)
sigma.t.4=sqrt(var4)
mu.t.1=rep(0,n)
mu.t.2=mu.sine
l2norm=function(x) sum(x^2)
mise=function(x,y) l2norm(x-y)/l2norm(y)
mse=function(x,y) mean((x-y)^2)
set.seed(327)
X.11=rnorm(n,mu.t.1,sigma.t.1)
set.seed(327)
X.12=rnorm(n,mu.t.1,sigma.t.2)
set.seed(327)
X.13=rnorm(n,mu.t.1,sigma.t.3)
set.seed(327)
X.14=rnorm(n,mu.t.1,sigma.t.4)
set.seed(327)
X.21=rnorm(n,mu.t.2,sigma.t.1)
set.seed(327)
X.22=rnorm(n,mu.t.2,sigma.t.2)
set.seed(327)
X.23=rnorm(n,mu.t.2,sigma.t.3)
set.seed(327)
X.24=rnorm(n,mu.t.2,sigma.t.4)
system.time(var.est.cur.11<-bayesmooth.cur(X.11))
system.time(var.est.cur.11<-bayesmooth.cur(X.11))system.time(var.est.v<-bayesmooth.vash(X.s,v.est=TRUE))
system.time(var.est.cur.11<-bayesmooth.cur(X.11))
system.time(var.est.cur.12<-bayesmooth.cur(X.12))
system.time(var.est.cur.13<-bayesmooth.cur(X.13))
system.time(var.est.cur.14<-bayesmooth.cur(X.14))
system.time(var.est.cur.21<-bayesmooth.cur(X.21))
system.time(var.est.cur.22<-bayesmooth.cur(X.22))
system.time(var.est.cur.23<-bayesmooth.cur(X.23))
system.time(var.est.cur.24<-bayesmooth.cur(X.24))
system.time(var.est.log.11<-bayesmooth.log(X.11))
system.time(var.est.log.12<-bayesmooth.log(X.12))
system.time(var.est.log.13<-bayesmooth.log(X.13))
system.time(var.est.log.14<-bayesmooth.log(X.14))
system.time(var.est.log.21<-bayesmooth.log(X.21))
system.time(var.est.log.22<-bayesmooth.log(X.22))
system.time(var.est.log.23<-bayesmooth.log(X.23))
system.time(var.est.log.24<-bayesmooth.log(X.24))
system.time(var.est.jash.11<-bayesmooth.jash(X.11))
system.time(var.est.jash.12<-bayesmooth.jash(X.12))
system.time(var.est.jash.13<-bayesmooth.jash(X.13))
system.time(var.est.jash.14<-bayesmooth.jash(X.14))
system.time(var.est.jash.21<-bayesmooth.jash(X.21))
system.time(var.est.jash.22<-bayesmooth.jash(X.22))
system.time(var.est.jash.23<-bayesmooth.jash(X.23))
system.time(var.est.jash.24<-bayesmooth.jash(X.24))
system.time(var.est.vash.11<-bayesmooth.vash(X.11))
system.time(var.est.vash.12<-bayesmooth.vash(X.12))
system.time(var.est.vash.13<-bayesmooth.vash(X.13))
system.time(var.est.vash.14<-bayesmooth.vash(X.14))
system.time(var.est.vash.21<-bayesmooth.vash(X.21))
system.time(var.est.vash.22<-bayesmooth.vash(X.22))
system.time(var.est.vash.23<-bayesmooth.vash(X.23))
system.time(var.est.vash.24<-bayesmooth.vash(X.24))
source("../simulation_1d_g/wip/bayesmooth_jash.R")
source("../simulation_1d_g/wip/bayesmooth_vash.R")
system.time(var.est.cur.11<-bayesmooth.cur(X.11,mu.t.1))
system.time(var.est.cur.12<-bayesmooth.cur(X.12,mu.t.1))
system.time(var.est.cur.13<-bayesmooth.cur(X.13,mu.t.1))
system.time(var.est.cur.14<-bayesmooth.cur(X.14,mu.t.1))
system.time(var.est.cur.21<-bayesmooth.cur(X.21,mu.t.2))
system.time(var.est.cur.22<-bayesmooth.cur(X.22,mu.t.2))
system.time(var.est.cur.23<-bayesmooth.cur(X.23,mu.t.2))
system.time(var.est.cur.24<-bayesmooth.cur(X.24,mu.t.2))
system.time(var.est.log.11<-bayesmooth.log(X.11,mu.t.1))
system.time(var.est.log.12<-bayesmooth.log(X.12,mu.t.1))
system.time(var.est.log.13<-bayesmooth.log(X.13,mu.t.1))
system.time(var.est.log.14<-bayesmooth.log(X.14,mu.t.1))
system.time(var.est.log.21<-bayesmooth.log(X.21,mu.t.2))
system.time(var.est.log.22<-bayesmooth.log(X.22,mu.t.2))
system.time(var.est.log.23<-bayesmooth.log(X.23,mu.t.2))
system.time(var.est.log.24<-bayesmooth.log(X.24,mu.t.2))
system.time(var.est.jash.11<-bayesmooth.jash(X.11,mu.t.1))
system.time(var.est.jash.12<-bayesmooth.jash(X.12,mu.t.1))
system.time(var.est.jash.13<-bayesmooth.jash(X.13,mu.t.1))
system.time(var.est.jash.14<-bayesmooth.jash(X.14,mu.t.1))
system.time(var.est.jash.21<-bayesmooth.jash(X.21,mu.t.2))
system.time(var.est.jash.22<-bayesmooth.jash(X.22,mu.t.2))
system.time(var.est.jash.23<-bayesmooth.jash(X.23,mu.t.2))
system.time(var.est.jash.24<-bayesmooth.jash(X.24,mu.t.2))
system.time(var.est.vash.11<-bayesmooth.vash(X.11,mu.t.1))
source("../simulation_1d_g/wip/bayesmooth_log.R")
system.time(var.est.log.11<-bayesmooth.log(X.11,mu.t.1))
system.time(var.est.log.12<-bayesmooth.log(X.12,mu.t.1))
system.time(var.est.log.13<-bayesmooth.log(X.13,mu.t.1))
system.time(var.est.log.14<-bayesmooth.log(X.14,mu.t.1))
system.time(var.est.log.21<-bayesmooth.log(X.21,mu.t.2))
system.time(var.est.log.22<-bayesmooth.log(X.22,mu.t.2))
system.time(var.est.log.23<-bayesmooth.log(X.23,mu.t.2))
system.time(var.est.log.24<-bayesmooth.log(X.24,mu.t.2))
source("../simulation_1d_g/wip/bayesmooth_log.R")
system.time(var.est.log.11<-bayesmooth.log(X.11,mu.t.1))
system.time(var.est.log.12<-bayesmooth.log(X.12,mu.t.1))
system.time(var.est.log.13<-bayesmooth.log(X.13,mu.t.1))
system.time(var.est.log.14<-bayesmooth.log(X.14,mu.t.1))
system.time(var.est.log.21<-bayesmooth.log(X.21,mu.t.2))
system.time(var.est.log.22<-bayesmooth.log(X.22,mu.t.2))
system.time(var.est.log.23<-bayesmooth.log(X.23,mu.t.2))
system.time(var.est.log.24<-bayesmooth.log(X.24,mu.t.2))
source("../simulation_1d_g/wip/bayesmooth_jash.R")
system.time(var.est.jash.11<-bayesmooth.jash(X.11,mu.t.1))
system.time(var.est.jash.12<-bayesmooth.jash(X.12,mu.t.1))
system.time(var.est.jash.13<-bayesmooth.jash(X.13,mu.t.1))
system.time(var.est.jash.14<-bayesmooth.jash(X.14,mu.t.1))
system.time(var.est.jash.21<-bayesmooth.jash(X.21,mu.t.2))
system.time(var.est.jash.22<-bayesmooth.jash(X.22,mu.t.2))
system.time(var.est.jash.23<-bayesmooth.jash(X.23,mu.t.2))
system.time(var.est.jash.24<-bayesmooth.jash(X.24,mu.t.2))
source("../simulation_1d_g/wip/bayesmooth_vash.R")
system.time(var.est.vash.11<-bayesmooth.vash(X.11,mu.t.1))
system.time(var.est.vash.12<-bayesmooth.vash(X.12,mu.t.1))
system.time(var.est.vash.13<-bayesmooth.vash(X.13,mu.t.1))
system.time(var.est.vash.14<-bayesmooth.vash(X.14,mu.t.1))
system.time(var.est.vash.21<-bayesmooth.vash(X.21,mu.t.2))
system.time(var.est.vash.22<-bayesmooth.vash(X.22,mu.t.2))
system.time(var.est.vash.23<-bayesmooth.vash(X.23,mu.t.2))
system.time(var.est.vash.24<-bayesmooth.vash(X.24,mu.t.2))
matrix(c(mse(var.est.cur.11,sigma.t.1^2),
mse(var.est.cur.12,sigma.t.2^2),
mse(var.est.cur.13,sigma.t.3^2),
mse(var.est.cur.14,sigma.t.4^2),
mse(var.est.log.11,sigma.t.1^2),
mse(var.est.log.12,sigma.t.2^2),
mse(var.est.log.13,sigma.t.3^2),
mse(var.est.log.14,sigma.t.4^2),
mse(var.est.vash.11,sigma.t.1^2),
mse(var.est.vash.12,sigma.t.2^2),
mse(var.est.vash.13,sigma.t.3^2),
mse(var.est.vash.14,sigma.t.4^2),
mse(var.est.jash.11,sigma.t.1^2),
mse(var.est.jash.12,sigma.t.2^2),
mse(var.est.jash.13,sigma.t.3^2),
mse(var.est.jash.14,sigma.t.4^2),
4,4)
matrix(c(mse(var.est.cur.11,sigma.t.1^2),
mse(var.est.cur.12,sigma.t.2^2),
mse(var.est.cur.13,sigma.t.3^2),
mse(var.est.cur.14,sigma.t.4^2),
mse(var.est.log.11,sigma.t.1^2),
mse(var.est.log.12,sigma.t.2^2),
mse(var.est.log.13,sigma.t.3^2),
mse(var.est.log.14,sigma.t.4^2),
mse(var.est.vash.11,sigma.t.1^2),
mse(var.est.vash.12,sigma.t.2^2),
mse(var.est.vash.13,sigma.t.3^2),
mse(var.est.vash.14,sigma.t.4^2),
mse(var.est.jash.11,sigma.t.1^2),
mse(var.est.jash.12,sigma.t.2^2),
mse(var.est.jash.13,sigma.t.3^2),
mse(var.est.jash.14,sigma.t.4^2)),
4,4)
plot(sigma.t.1^2,type='l')
lines(var.est.log.11,col=2)
plot(var.est.log.11)
lines(var.est.log.11,col=2)
plot(sigma.t.1^2,type='l')
lines(var.est.log.11,col=2)
plot(sigma.t.4^2,type='l')
lines(var.est.log.14,col=2)
plot(sigma.t.3^2,type='l')
lines(var.est.log.13,col=2)
source("../simulation_1d_g/wip/bayesmooth_log.R")
system.time(var.est.log.11<-bayesmooth.log(X.11,mu.t.1))
system.time(var.est.log.12<-bayesmooth.log(X.12,mu.t.1))
system.time(var.est.log.13<-bayesmooth.log(X.13,mu.t.1))
system.time(var.est.log.14<-bayesmooth.log(X.14,mu.t.1))
system.time(var.est.log.21<-bayesmooth.log(X.21,mu.t.2))
system.time(var.est.log.22<-bayesmooth.log(X.22,mu.t.2))
system.time(var.est.log.23<-bayesmooth.log(X.23,mu.t.2))
system.time(var.est.log.24<-bayesmooth.log(X.24,mu.t.2))
matrix(c(mse(var.est.cur.11,sigma.t.1^2),
mse(var.est.cur.12,sigma.t.2^2),
mse(var.est.cur.13,sigma.t.3^2),
mse(var.est.cur.14,sigma.t.4^2),
mse(var.est.log.11,sigma.t.1^2),
mse(var.est.log.12,sigma.t.2^2),
mse(var.est.log.13,sigma.t.3^2),
mse(var.est.log.14,sigma.t.4^2),
mse(var.est.vash.11,sigma.t.1^2),
mse(var.est.vash.12,sigma.t.2^2),
mse(var.est.vash.13,sigma.t.3^2),
mse(var.est.vash.14,sigma.t.4^2),
mse(var.est.jash.11,sigma.t.1^2),
mse(var.est.jash.12,sigma.t.2^2),
mse(var.est.jash.13,sigma.t.3^2),
mse(var.est.jash.14,sigma.t.4^2)),
4,4)
plot(sigma.t.1^2,type='l')
lines(var.est.log.11,col=2)
source("../simulation_1d_g/wip/bayesmooth_log.R")
system.time(var.est.log.11<-bayesmooth.log(X.11,mu.t.1,sigma.t.1))
system.time(var.est.log.12<-bayesmooth.log(X.12,mu.t.1,sigma.t.2))
system.time(var.est.log.13<-bayesmooth.log(X.13,mu.t.1,sigma.t.3))
system.time(var.est.log.14<-bayesmooth.log(X.14,mu.t.1,sigma.t.4))
system.time(var.est.log.21<-bayesmooth.log(X.21,mu.t.2,sigma.t.1))
system.time(var.est.log.22<-bayesmooth.log(X.22,mu.t.2,sigma.t.2))
system.time(var.est.log.23<-bayesmooth.log(X.23,mu.t.2,sigma.t.3))
system.time(var.est.log.24<-bayesmooth.log(X.24,mu.t.2,sigma.t.4))
matrix(c(mse(var.est.cur.11,sigma.t.1^2),
mse(var.est.cur.12,sigma.t.2^2),
mse(var.est.cur.13,sigma.t.3^2),
mse(var.est.cur.14,sigma.t.4^2),
mse(var.est.log.11,sigma.t.1^2),
mse(var.est.log.12,sigma.t.2^2),
mse(var.est.log.13,sigma.t.3^2),
mse(var.est.log.14,sigma.t.4^2),
mse(var.est.vash.11,sigma.t.1^2),
mse(var.est.vash.12,sigma.t.2^2),
mse(var.est.vash.13,sigma.t.3^2),
mse(var.est.vash.14,sigma.t.4^2),
mse(var.est.jash.11,sigma.t.1^2),
mse(var.est.jash.12,sigma.t.2^2),
mse(var.est.jash.13,sigma.t.3^2),
mse(var.est.jash.14,sigma.t.4^2)),
4,4)
plot(sigma.t.1^2,type='l')
lines(var.est.log.11,col=2)
mse(var.est.log.11,sigma.t.1^2)
source("../simulation_1d_g/wip/bayesmooth_log.R")
system.time(var.est.log.11<-bayesmooth.log(X.11,mu.t.1,sigma.t.1))
system.time(var.est.log.12<-bayesmooth.log(X.12,mu.t.1,sigma.t.2))
system.time(var.est.log.13<-bayesmooth.log(X.13,mu.t.1,sigma.t.3))
system.time(var.est.log.14<-bayesmooth.log(X.14,mu.t.1,sigma.t.4))
system.time(var.est.log.21<-bayesmooth.log(X.21,mu.t.2,sigma.t.1))
system.time(var.est.log.22<-bayesmooth.log(X.22,mu.t.2,sigma.t.2))
system.time(var.est.log.23<-bayesmooth.log(X.23,mu.t.2,sigma.t.3))
system.time(var.est.log.24<-bayesmooth.log(X.24,mu.t.2,sigma.t.4))
matrix(c(mse(var.est.cur.11,sigma.t.1^2),
mse(var.est.cur.12,sigma.t.2^2),
mse(var.est.cur.13,sigma.t.3^2),
mse(var.est.cur.14,sigma.t.4^2),
mse(var.est.log.11,sigma.t.1^2),
mse(var.est.log.12,sigma.t.2^2),
mse(var.est.log.13,sigma.t.3^2),
mse(var.est.log.14,sigma.t.4^2),
mse(var.est.vash.11,sigma.t.1^2),
mse(var.est.vash.12,sigma.t.2^2),
mse(var.est.vash.13,sigma.t.3^2),
mse(var.est.vash.14,sigma.t.4^2),
mse(var.est.jash.11,sigma.t.1^2),
mse(var.est.jash.12,sigma.t.2^2),
mse(var.est.jash.13,sigma.t.3^2),
mse(var.est.jash.14,sigma.t.4^2)),
4,4)
source("../simulation_1d_g/wip/bayesmooth_log.R")
system.time(var.est.log.11<-bayesmooth.log(X.11,mu.t.1,sigma.t.1))
system.time(var.est.log.12<-bayesmooth.log(X.12,mu.t.1,sigma.t.2))
system.time(var.est.log.13<-bayesmooth.log(X.13,mu.t.1,sigma.t.3))
system.time(var.est.log.14<-bayesmooth.log(X.14,mu.t.1,sigma.t.4))
system.time(var.est.log.21<-bayesmooth.log(X.21,mu.t.2,sigma.t.1))
system.time(var.est.log.22<-bayesmooth.log(X.22,mu.t.2,sigma.t.2))
system.time(var.est.log.23<-bayesmooth.log(X.23,mu.t.2,sigma.t.3))
system.time(var.est.log.24<-bayesmooth.log(X.24,mu.t.2,sigma.t.4))
matrix(c(mse(var.est.cur.11,sigma.t.1^2),
mse(var.est.cur.12,sigma.t.2^2),
mse(var.est.cur.13,sigma.t.3^2),
mse(var.est.cur.14,sigma.t.4^2),
mse(var.est.log.11,sigma.t.1^2),
mse(var.est.log.12,sigma.t.2^2),
mse(var.est.log.13,sigma.t.3^2),
mse(var.est.log.14,sigma.t.4^2),
mse(var.est.vash.11,sigma.t.1^2),
mse(var.est.vash.12,sigma.t.2^2),
mse(var.est.vash.13,sigma.t.3^2),
mse(var.est.vash.14,sigma.t.4^2),
mse(var.est.jash.11,sigma.t.1^2),
mse(var.est.jash.12,sigma.t.2^2),
mse(var.est.jash.13,sigma.t.3^2),
mse(var.est.jash.14,sigma.t.4^2)),
4,4)
knit2html("tests.Rmd")
knit2html("tests.Rmd")
