"0","pos <- c(0.1,0.13,0.15,0.23,0.25,0.4,0.44,0.65,0.76,0.78,0.81)"
"0","hgt <- 2.88/5 * c(4,-5,3,-4,5,-4.2,2.1,4.3,-3.1,2.1,-4.2)"
"0","sig.cb <- rep(0,length(t))"
"0","for (j in 1:length(pos)) "
"0","  sig.cb <- sig.cb + (1 + sign(t - pos[j])) * (hgt[j]/2)"
"0","sig.cb[sig.cb < 0] <- 0"
"0","sig.cb <- 0.1 + (sig.cb - min(sig.cb))/max(sig.cb)"
"0","rsnr   <- sqrt(3)"
"0","sig.cb <- sig.cb/mean(sig.cb) * sd(mu.sp)/rsnr^2"
"0","x.sim  <- rnorm(n,mu.sp,sig.cb)"
